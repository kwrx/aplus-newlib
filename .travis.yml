language: c
os: linux
dist: bionic

jobs:
  include:
    - os: linux
      env:
        - HOST="x86_64"
    - os: linux
      env:
        - HOST="i686"

script:
  ci/build.sh ${HOST}

install:
  ci/install.sh



before_deploy:
  - git config --local user.name "Antonino Natale"
  - git config --local user.email "antonio.natale97@hotmail.com"
  - export TRAVIS_TAG=v0.6.$(date +'%Y%m%d')
  - git tag $TRAVIS_TAG

deploy:
  provider: releases
  api_key:
    secure: aR6oKrdl/5dfmCcwqYyDrM2x0B57rpYFl7YXOP6LjcDG4VDHXmK34ZiQ2HxpWPBlQisJZOVipy9bTuj86ctDWX7wRqIxp8YcwmJQ6UoexXw2I2uohlxQ7O4o231kuwkALPKV34U/uh/3M6LLsmCHD4t3pgz/VbAow2PvBM8KmFuSFf+iQq8T88oeg56PmfT84Bi9T/VprmjRewzHUAMmJFqwlBcNPeJpLET5Y5jR4f8Karqhs+jmZpD7eFmGBcDAC99zsDhE89XqraX2lWRIoZAivXxLGu9CiXKKGgbYm1z3eGbih08a4xgqZDoEWTti0jRDuwKP3a0RKV3uLE3gRQIVEp6IWXlWIcyVRFDHdaIAxHSWPzN9VkzqerZuMWcXnH3r1SWZJ89b+cI/ehFX2yEPjaP0jvGqxNhzhowK/0sDlZUqniE9pmGEwM7bginI4McKHPDFFX+QW4Em+2DLBD1rj9CwrWHH9ilHNxMfF2JmDiyZmanNtXQRtUQwZwoV3QDgniiBiCjK85BQLOY63Kmf5xaUShe1azEzVyGcl7DKMixxJ4zGFiTSX6JBuGwGvHmsfZY1jhXGepEykrUWDjhNc36c6/0wEy7yWZXsxc5ZetlX9drjJF4wi3bszH0CWCBjKnx51zLEZTBkVwZ/gQ1U+EBhAC3Grmh8C+9meT4=
    
  file:
    ${HOST}-aplus-newlib.tar.xz

  cleanup: false
  overwrite: true
  draft: false

  on:
    repo: kwrx/aplus-newlib
    tags: false
