language: c
os: linux
dist: bionic

jobs:
  include:
    - os: linux
      env:
        - HOST="x86_64"
    - os: linux
      env:
        - HOST="i686"

script:
  ci/build.sh ${HOST}

install:
  ci/install.sh



before_deploy:
  - git config --local user.name "Antonino Natale"
  - git config --local user.email "antonio.natale97@hotmail.com"
  - export TRAVIS_TAG=v0.6.$(date +'%Y%m%d')
  - git tag $TRAVIS_TAG

deploy:
  provider: releases
  token:
    secure: NOzc5yhKOlCjW1lBWEUSc3SjdYWBuQik1ophUfNDw9Zk3pOVaIeYFgMc8z6iOQOEz5OEsfCVTIQzotbKzGj8LCmbiPuXREW5InX2zuUsg2226swlNIlzuU2hPFsTbDEKNHBgNE2TPqcR/mf3bmN/vpIHHvfOd2DvZ6IJ2E/bRffFf45bQZ2pyEDIz4ChWraEz0C14DRkXS3p30r3/GhiEua2t96LUSaTkv4htJf3IwwR4A7vYeJfQWoqC3uVYoxL/bqv4kVhvE9th09VQdNJoq7QcRlMFfEQgwr0DyZ9P9IS4FrAeBnUjWG3iYvg/OYSEXDvQ/Vqvq9JYonu0s4zPaZOxVrLPHiCBMTKgP5k4TCw9lcBwPQSqKymzu34KIELBc3vCm2yNYqurl4ipgwxa1Pq6rSsAw6td3NkgGjdrq+PYpg3h5d+51fxoVTrUS/PMG6vIvxdZM0wrTe+FHFQB9uKmSwyxSf7H37xIu291YZGNbiTYtu6aG0ZBgVnfBGrtS5lwpTH0BKx4Li8m2thWkLFDuZn4Gn23EZ61D0mamaUwn4Es9wYPO4xUiJKfK81Q66NLrrdzyytu5Z8yYP7JL623mMc+h194eKpf3j9T5Hrb1qbiO3oItdCX+Z5tYWCEd4iG6O5OOajhsDIQH0S+UtzEX2Y9RarsJ8tIOdz7rA=
    
  file:
    ${HOST}-aplus-newlib.tar.xz

  cleanup: false
  overwrite: true
  draft: false

  on:
    repo: kwrx/aplus-newlib
    tags: false
